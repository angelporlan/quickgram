<div class="ranking-container">
    <div class="header">
        <h1>Global Leaderboard</h1>
        <p>Top performant users across the platform</p>
    </div>

    <div class="tabs">
        <button class="tab-btn" [class.active]="activeTab === 'mostActive'" (click)="switchTab('mostActive')">
            Most Active
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'highestAverage'" (click)="switchTab('highestAverage')">
            Highest Average Score
        </button>
    </div>

    <div class="loading" *ngIf="isLoading">
        <div class="spinner"></div>
    </div>

    <div class="ranking-list" *ngIf="!isLoading">
        <div class="list-header">
            <span class="rank-col">#</span>
            <span class="user-col">User</span>
            <span class="stat-col">{{ activeTab === 'mostActive' ? 'Exercises' : 'Avg. Score' }}</span>
        </div>

        <div class="ranking-item" *ngFor="let item of rankings; let i = index">
            <div class="rank-col">
                <span class="rank-badge" [class.top-1]="(currentPage - 1) * pageSize + i === 0"
                    [class.top-2]="(currentPage - 1) * pageSize + i === 1"
                    [class.top-3]="(currentPage - 1) * pageSize + i === 2">
                    {{ (currentPage - 1) * pageSize + i + 1 }}
                </span>
            </div>
            <div class="user-col">
                <img [src]="getAvatarUrl(item.avatar_seed)" alt="avatar" class="avatar">
                <span class="username">{{ item.username }}</span>
            </div>
            <div class="stat-col">
                <span class="stat-value">
                    {{ activeTab === 'mostActive' ? item.value : (item.value | number:'1.1-2') }}
                </span>
                <span class="stat-label" *ngIf="activeTab === 'highestAverage'">/ 10</span>
            </div>
        </div>

        <div class="empty-state" *ngIf="rankings.length === 0">
            <p>No rankings available yet.</p>
        </div>

        <div class="pagination-controls" *ngIf="totalPages > 1">
            <button class="page-btn" (click)="prevPage()" [disabled]="currentPage === 1">Previous</button>
            <span class="page-info">Page {{ currentPage }} of {{ totalPages }}</span>
            <button class="page-btn" (click)="nextPage()" [disabled]="currentPage === totalPages">Next</button>
        </div>
    </div>
</div>